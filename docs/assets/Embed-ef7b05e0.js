import{S as M,i as C,s as x,q as P,x as H,C as T,y as A,a as R,u as S,r as k,v as W,b as N,t as B,d as U,O as L,o as z}from"./index-8607ceaf.js";import{g as O}from"./_commonjsHelpers-725317a4.js";var I={exports:{}};/*! pym.js - v1.3.2 - 2018-02-13 */(function(f){(function(l){f.exports?f.exports=l():window.pym=l.call(this)})(function(){var l="xPYMx",a={},g=function(i){var n=document.createEvent("Event");n.initEvent("pym:"+i,!0,!0),document.dispatchEvent(n)},d=function(i){var n=new RegExp("[\\?&]"+i.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)"),r=n.exec(location.search);return r===null?"":decodeURIComponent(r[1].replace(/\+/g," "))},h=function(i,n){if(!(n.xdomain!=="*"&&!i.origin.match(new RegExp(n.xdomain+"$")))&&typeof i.data=="string")return!0},p=function(i){var n=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi;if(i.match(n))return!0},c=function(i,n,r){var u=["pym",i,n,r];return u.join(l)},b=function(i){var n=["pym",i,"(\\S+)","(.*)"];return new RegExp("^"+n.join(l)+"$")},_=Date.now||function(){return new Date().getTime()},E=function(i,n,r){var u,t,e,s=null,o=0;r||(r={});var m=function(){o=r.leading===!1?0:_(),s=null,e=i.apply(u,t),s||(u=t=null)};return function(){var v=_();!o&&r.leading===!1&&(o=v);var w=n-(v-o);return u=this,t=arguments,w<=0||w>n?(s&&(clearTimeout(s),s=null),o=v,e=i.apply(u,t),s||(u=t=null)):!s&&r.trailing!==!1&&(s=setTimeout(m,w)),e}},y=function(){for(var i=a.autoInitInstances.length,n=i-1;n>=0;n--){var r=a.autoInitInstances[n];r.el.getElementsByTagName("iframe").length&&r.el.getElementsByTagName("iframe")[0].contentWindow||a.autoInitInstances.splice(n,1)}};return a.autoInitInstances=[],a.autoInit=function(i){var n=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),r=n.length;y();for(var u=0;u<r;++u){var t=n[u];t.setAttribute("data-pym-auto-initialized",""),t.id===""&&(t.id="pym-"+u+"-"+Math.random().toString(36).substr(2,5));var e=t.getAttribute("data-pym-src"),s={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},o={};for(var m in s)if(t.getAttribute("data-pym-"+m)!==null)switch(s[m]){case"boolean":o[m]=t.getAttribute("data-pym-"+m)!=="false";break;case"string":o[m]=t.getAttribute("data-pym-"+m);break;case"number":var v=Number(t.getAttribute("data-pym-"+m));isNaN(v)||(o[m]=v);break;default:console.err("unrecognized attribute type")}var w=new a.Parent(t.id,e,o);a.autoInitInstances.push(w)}return i||g("pym-initialized"),a.autoInitInstances},a.Parent=function(i,n,r){this.id=i,this.url=n,this.el=document.getElementById(i),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=b(this.id),this.messageHandlers={},r=r||{},this._constructIframe=function(){var t=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var e="",s=this.url.indexOf("#");for(s>-1&&(e=this.url.substring(s,this.url.length),this.url=this.url.substring(0,s)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+t+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=e,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),this.settings.allowfullscreen!==void 0&&this.settings.allowfullscreen!==!1&&this.iframe.setAttribute("allowfullscreen",""),this.settings.sandbox!==void 0&&typeof this.settings.sandbox=="string"&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}.bind(this),this._onScroll=function(){this.sendViewportAndIFramePosition()}.bind(this),this._fire=function(t,e){if(t in this.messageHandlers)for(var s=0;s<this.messageHandlers[t].length;s++)this.messageHandlers[t][s].call(this,e)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),y()},this._processMessage=function(t){if(h(t,this.settings)&&typeof t.data=="string"){var e=t.data.match(this.messageRegex);if(!e||e.length!==3)return!1;var s=e[1],o=e[2];this._fire(s,o)}}.bind(this),this._onHeightMessage=function(t){var e=parseInt(t);this.iframe.setAttribute("height",e+"px")},this._onNavigateToMessage=function(t){p(t)&&(document.location.href=t)},this._onScrollToChildPosMessage=function(t){var e=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset,s=e+parseInt(t);window.scrollTo(0,s)},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this.sendMessage=function(t,e){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(c(this.id,t,e),"*"):this.remove())},this.sendWidth=function(){var t=this.el.offsetWidth.toString();this.sendMessage("width",t)},this.sendViewportAndIFramePosition=function(){var t=this.iframe.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight,o=e+" "+s;o+=" "+t.top+" "+t.left,o+=" "+t.bottom+" "+t.right,this.sendMessage("viewport-iframe-position",o)};for(var u in r)this.settings[u]=r[u];return this._throttleOnScroll=E(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},a.Child=function(i){this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},i=i||{},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this._fire=function(t,e){if(t in this.messageHandlers)for(var s=0;s<this.messageHandlers[t].length;s++)this.messageHandlers[t][s].call(this,e)},this._processMessage=function(t){if(h(t,this.settings)&&typeof t.data=="string"){var e=t.data.match(this.messageRegex);if(!(!e||e.length!==3)){var s=e[1],o=e[2];this._fire(s,o)}}}.bind(this),this._onWidthMessage=function(t){var e=parseInt(t);e!==this.parentWidth&&(this.parentWidth=e,this.settings.renderCallback&&this.settings.renderCallback(e),this.sendHeight())},this.sendMessage=function(t,e){window.parent.postMessage(c(this.id,t,e),"*")},this.sendHeight=function(){var t=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",t),t}.bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(t){this.sendMessage("navigateTo","#"+t)},this.navigateParentTo=function(t){this.sendMessage("navigateTo",t)},this.scrollParentToChildEl=function(t){var e=document.getElementById(t).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(e)},this.scrollParentToChildPos=function(t){this.sendMessage("scrollToChildPos",t.toString())};var n=function(t){var e=document.getElementsByTagName("html")[0],s,o=e.className;try{window.self!==window.top?s="embedded":s="not-embedded"}catch{s="embedded"}o.indexOf(s)<0&&(e.className=o?o+" "+s:s,t&&t(s),g("marked-embedded"))};this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)};for(var r in i)this.settings[r]=i[r];this.id=d("childId")||i.id,this.messageRegex=new RegExp("^pym"+l+this.id+l+"(\\S+)"+l+"(.*)$");var u=parseInt(d("initialWidth"));return this.parentUrl=d(this.settings.parenturlparam),this.parentTitle=d("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(u),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),n(i.onMarkedEmbeddedStatus),this},typeof document<"u"&&a.autoInit(!0),a})})(I);var F=I.exports;const j=O(F);function D(f){let l,a;const g=f[2].default,d=P(g,f,f[1],null);return{c(){l=H("div"),d&&d.c(),T(l,"class","embed-container svelte-ubitk5"),A(l,"display","content")},m(h,p){R(h,l,p),d&&d.m(l,null),a=!0},p(h,[p]){d&&d.p&&(!a||p&2)&&S(d,g,h,h[1],a?W(g,h[1],p,null):k(h[1]),null)},i(h){a||(N(d,h),a=!0)},o(h){B(d,h),a=!1},d(h){h&&U(l),d&&d.d(h)}}}function V(f,l,a){let{$$slots:g={},$$scope:d}=l,{pymChild:h=null}=l;const p=L();return z(()=>{a(0,h=new j.Child({polling:500}));const c=document.location.href,b=new URLSearchParams(document.location.search).get("parentUrl");p("load",{href:c,parentUrl:b})}),f.$$set=c=>{"pymChild"in c&&a(0,h=c.pymChild),"$$scope"in c&&a(1,d=c.$$scope)},[h,d,g]}class q extends M{constructor(l){super(),C(this,l,V,D,x,{pymChild:0})}}q.__docgen={version:3,name:"Embed.svelte",data:[{keywords:[{name:"type",description:"{object}"}],visibility:"public",description:"Binding for pymChild element (can be used to send messages to parent of iframe)",name:"pymChild",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"object",type:"object"},defaultValue:null}],computed:[],methods:[],components:[],description:null,keywords:[],events:[{visibility:"public",description:null,keywords:[],name:"load"}],slots:[{keywords:[],visibility:"public",description:"",name:"default"}],refs:[]};export{q as E};
//# sourceMappingURL=Embed-ef7b05e0.js.map
