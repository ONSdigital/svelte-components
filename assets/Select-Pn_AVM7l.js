import{al as ce,am as de,p as ue,r as pe,a as i,$ as fe,l as ye,b as be,j as b,i as L,t as g,e as y,h as me,an as ve,f as P,u as Z,s as S,m as z,k as O,n as A,g as T,d as he,o as F,q as ge}from"./iframe-B0hZN5pk.js";import{i as ke}from"./create-runtime-stories-DOO9SlUq.js";import{h as we}from"./svelte-head-BuEDfl20.js";import{a as _e}from"./actions-aIhyfp1K.js";import{s as q}from"./attributes-DOTazdcx.js";import{s as K}from"./class-Dzh9Da8g.js";function xe(u,a,m){var p=ce(u,a);p&&p.set&&(u[a]=m,de(()=>{u[a]=null}))}var Ve=ve(b("<script><\/script><!>",1)),Ce=b("<label> </label>"),Le=b('<button type="reset" title="Clear selection" aria-label="Clear selection" class="ons-autocomplete-clear svelte-nc31vb"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 14 14" width="18"><path fill="currentColor" d="M13.6 1 l -0.71 -0.71 a 0.5 0.5 0 0 0 -0.71 0 l -5.25 5.25 l -5.25 -5.25 a 0.51 0.51 0 0 0 -0.71 0 l -0.71 0.71 a 0.5 0.5 0 0 0 0 0.71 l 5.25 5.25 l -5.25 5.25 a 0.5 0.5 0 0 0 0 0.71 l 0.71 0.71 a 0.5 0.5 0 0 0 0.71 0 l 5.25 -5.25 l 5.25 5.25 a 0.5 0.5 0 0 0 0.71 0 l 0.71 -0.71 a 0.5 0.5 0 0 0 0 -0.71 l -5.25 -5.25 l 5.25 -5.25 a 0.5 0.5 0 0 0 0 -0.71Z"></path></svg></button>'),Se=b("<div></div> <!>",1),Oe=b('<div><!> <div class="ons-autocomplete-wrapper svelte-nc31vb"><!></div></div>');function Ae(u,a){ue(a,!1);const m=pe(),p=(e=1e3)=>new Promise(t=>setTimeout(t,e)),G=e=>`<svg class="${e==null?void 0:e.className}" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 11.75 7.7" width="18" style="z-index:1"><path fill="currentColor" d="m1.37.15 4.5 5.1 4.5-5.1a.37.37 0 0 1 .6 0l.7.7a.45.45 0 0 1 0 .5l-5.5 6.2a.37.37 0 0 1-.6 0l-5.5-6.1a.64.64 0 0 1 0-.6l.7-.7a.64.64 0 0 1 .6 0Z"></path></svg>`;let n,k=z(),I,w=z(!1),f=i(a,"id",8,"autocomplete"),r=i(a,"mode",8,"default"),H=i(a,"clearable",24,()=>r()!=="search"),M=i(a,"autoClear",24,()=>r()==="search"),U=i(a,"label",24,()=>r()==="search"?"Type to select":"Select an option"),J=i(a,"hideLabel",8,!1),Q=i(a,"placeholder",24,()=>r()==="search"?"Enter text":"Select one"),s=i(a,"value",12,null),_=i(a,"options",24,()=>[]),c=i(a,"labelKey",8,"label"),j=i(a,"groupKey",8,null),W=i(a,"minLength",24,()=>r()==="search"?1:0),X=i(a,"loadOptions",8,(e,t)=>{const l=r()!=="search"&&_().map(o=>o[c()]).includes(e)?_():_().filter(o=>o[c()].match(new RegExp(`\\b${e.replace(/[^\w\s]/gi,"")}`,"i")));t(l)}),Y=i(a,"scriptUrl",8,"https://cdn.ons.gov.uk/vendor/accessible-autocomplete/3.0.1/accessible-autocomplete.min.js");async function v(){await h(null),m("clear",null)}let $=i(a,"cls",8,null);async function h(e){S(w,!0),n.value=e||"",await p(110),n.focus({preventScroll:!0}),n.blur(),S(w,!1)}function ee(e){return e&&e[c()]}function E(e,t=""){return e.replace(new RegExp(`\\b${t.replace(/[^\w\s]/gi,"")}`,"i"),l=>`<b>${l}</b>`)}function te(e){const t=(n==null?void 0:n.value)||"";return e&&(j()?`${E((e==null?void 0:e[c()])||"",t)} <span class="muted-text">${e[j()]}</span>`:E((e==null?void 0:e[c()])||"",t))}async function R(e){e&&s()!==e&&(s(e),m("change",s()),s()&&M()&&(await p(0),v()))}function ae(e){e.target.value||R(null)}function B(){!T(k)&&(window!=null&&window.accessibleAutocomplete)&&(I=window.accessibleAutocomplete,S(k,!0))}function x(e){var t;I({element:e,id:f(),name:`${f()}-input`,source:X(),autoselect:!0,onConfirm:R,confirmOnBlur:!1,placeholder:Q(),displayMenu:"overlay",showAllValues:r()==="default",dropdownArrow:G,minLength:W(),templates:{inputValue:ee,suggestion:te}}),n=e.querySelector(`#${f()}`),h(((t=s())==null?void 0:t[c()])||""),n.addEventListener("blur",ae)}function le(e){if(n){const t=e==null?void 0:e[c()];t&&n.value!==t?h(t):!e&&n.value&&h("")}}fe(B),ye(()=>he(s()),()=>{le(s())}),be(),ke();var V=Oe();we(e=>{var t=Ve(),l=P(t);O(l),g(()=>q(l,"src",Y())),Z("load",l,B),y(e,t)});var D=A(V);{var ie=e=>{var t=Ce();let l;var o=A(t);g(C=>{q(t,"for",f()),l=K(t,1,"ons-label",null,l,C),ge(o,U())},[()=>({"ons-u-vh":J()})],F),y(e,t)};L(D,e=>{U()&&e(ie)})}var ne=O(D,2),se=A(ne);{var oe=e=>{var t=Se(),l=P(t);let o;_e(l,d=>x==null?void 0:x(d));var C=O(l,2);{var re=d=>{var N=Le();Z("click",N,v),y(d,N)};L(C,d=>{H()&&!M()&&s()&&d(re)})}g(d=>{q(l,"id",`${f()??""}-container`),o=K(l,1,"ons-autocomplete svelte-nc31vb",null,o,d)},[()=>({"hide-menu":T(w)})],F),y(e,t)};L(se,e=>{T(k)&&e(oe)})}return g(()=>K(V,1,`ons-field ${$()??""}`,"svelte-nc31vb")),y(u,V),xe(a,"clearInput",v),me({clearInput:v})}Ae.__docgen={data:[{name:"id",visibility:"public",description:"Unique id for the element",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"autocomplete"'},{name:"mode",visibility:"public",description:'The mode can be either "default" or "search"',keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"string",value:"default",text:'"default"'},{kind:"const",type:"string",value:"search",text:'"search"'}],text:'"default" | "search"'},static:!1,readonly:!1,defaultValue:'"default"'},{name:"clearable",visibility:"public",description:"Defines whether the selection can be cleared",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"..."},{name:"autoClear",visibility:"public",description:'Clear value on selection (default for "search" mode)',keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"..."},{name:"label",visibility:"public",description:"A label to describe the element (expected for accessibility)",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"hideLabel",visibility:"public",description:"Visually hide the label",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"placeholder",visibility:"public",description:"An optional placeholder text",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"..."},{name:"value",visibility:"public",description:"A prop to bind to for the selected value",keywords:[],kind:"let",static:!1,readonly:!1,defaultValue:"null"},{name:"options",visibility:"public",description:"An array of options, formatted {id, label}",keywords:[],kind:"let",type:{kind:"type",type:"any",text:"any"},static:!1,readonly:!1,defaultValue:"[]"},{name:"labelKey",visibility:"public",description:"The attribute of an option that defines its label/name",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"label"'},{name:"groupKey",visibility:"public",description:"The attribute of an option that defines its group (optional)",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"null"},{name:"minLength",visibility:"public",description:"Optional: Minimum query length to return results",keywords:[],kind:"let",type:{kind:"type",type:"number",text:"number"},static:!1,readonly:!1,defaultValue:"..."},{name:"loadOptions",visibility:"public",description:"Optional: Override function for loading/filtering options based on the entered text",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Function"},static:!1,readonly:!1,defaultValue:"function"},{name:"scriptUrl",visibility:"public",description:"Optional: Override the default CDN URL for the accessible-autocomplete script",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"https://cdn.ons.gov.uk/vendor/accessible-autocomplete/3.0.1/accessible-autocomplete.min.js"'},{name:"clearInput",visibility:"public",keywords:[{name:"required",description:""}],kind:"let",type:{kind:"function",text:"() => Promise<void>"},static:!1,readonly:!1},{name:"cls",visibility:"public",description:"Optional: Set an additional CSS class for the component",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:"null"}],name:"Select.svelte"};export{Ae as S};
