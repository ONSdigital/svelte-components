import{p as He,O as Me,a as A,W as L,l as qe,b as Be,c as F,f as G,i as M,g as t,m as ge,e as y,h as Fe,X as Ie,P as T,k as de,n as re,s as me,d as Je,t as se,o as oe,q as ve}from"./iframe-CLrlnsTP.js";import{i as De}from"./create-runtime-stories-B2eo7_kk.js";import{e as he,i as _e}from"./each-Cs4okM3g.js";import{a as P}from"./actions-CIBudo9R.js";import{s as v}from"./attributes-BPiJ-9gJ.js";import{w as Ee}from"./DotPlotChart.svelte_svelte_type_style_lang-DGev7cCI.js";function Pe(x){x.nextSibling&&x.parentNode.appendChild(x)}const Te=(x,a)=>{let c=x.map((h,e)=>h-e*a*2);return Xe(c).map((h,e)=>h+e*a*2)},Xe=x=>{let a=[];for(let h of x)for(a.push({size:1,mean:h});a.length>1;){let e=a[a.length-2],_=a[a.length-1];if(e.mean<_.mean)break;e.mean=(e.mean*e.size+_.mean*_.size)/(e.size+_.size),e.size=e.size+_.size,a.pop()}let c=[];for(const h of a)for(let e=0;e<h.size;e++)c.push(h.mean);return c};var Ye=T('<text class="chart-label svelte-1yprmt" transform="translate(5,-5)" filter="url(#bgfill)"> </text>'),Ze=T("<circle></circle>"),je=T('<!><text class="chart-label svelte-1yprmt" filter="url(#bgfill)"> </text>',1),Qe=T('<defs><filter x="0" y="0" width="1" height="1" id="bgfill"><feFlood flood-color="rgba(255,255,255,0.8)" result="bg"></feFlood><feMerge><feMergeNode in="bg"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g class="chart-label-group"><!></g>',1);function lt(x,a){He(a,!1);const[c,h]=Ie(),e=()=>L(ke,"$custom",c),_=()=>L(ye,"$yScale",c),I=()=>L(Ne,"$coords",c),f=()=>L(pe,"$data",c),X=()=>L(Se,"$config",c),Y=()=>L(ue,"$zGet",c),Z=()=>L(be,"$xScale",c),xe=()=>L(ze,"$padding",c),K=ge(),{data:pe,xScale:be,yScale:ye,zGet:ue,padding:ze,config:Se,custom:ke}=Me("LayerCake");let N=A(a,"hovered",8,null),ne=A(a,"selected",8,null),q=A(a,"labelAll",8,!1),j=A(a,"spreadLabels",8,!1),J=A(a,"content",8,null),ce=A(a,"marker",8,!1),Le=A(a,"textWrap",8,!1),Ne=e().coords,w=e().idKey,fe=e().labelKey,Q=e().colorHover?e().colorHover:"orange",U=e().colorSelect?e().colorSelect:"#206095",V=ge(8),we=4;const Ce=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/,O=(r,i={})=>{i.disable||Pe(r)},R=(r,i={})=>{i.first&&me(V,r.getBBox().height/2)},$e=(r,i)=>{const u=Array.from(r.keys()).sort((l,s)=>r[s][r[s].length-1].y-r[l][r[l].length-1].y),ee=Array.from(u.keys()).map(l=>u.indexOf(l));let W=r.map((l,s)=>r[u[s]]);const te=Te(W.map(l=>_()(l[l.length-1].y)),i);return W=W.map((l,s)=>{const g=JSON.parse(JSON.stringify(l));return g.forEach(p=>{Ce.test(p.x)&&(p.x=new Date(p.x))}),g[g.length-1].ly=te[s],g}),ee.map(l=>W[l])};qe(()=>(I(),Je(j()),t(V)),()=>{var r,i,u;me(K,(u=(i=(r=I())==null?void 0:r[0])==null?void 0:i[0])!=null&&u.y&&j()?$e(I(),t(V)):I())}),Be(),De();var ie=F(),Ae=G(ie);{var Ge=r=>{var i=Qe(),u=de(G(i)),ee=re(u);{var W=l=>{var s=F(),g=G(s);he(g,1,()=>t(K),_e,(p,z,b)=>{var C=F(),o=G(C);{var d=H=>{var $=Ye(),ae=re($);se((B,D,E)=>{v($,"fill",B),v($,"x",D),v($,"y",E),ve(ae,J()?J():f()[b][fe])},[()=>q()&&X().z?Y()(f()[b]):f()[b][w]===N()?Q:U,()=>Z()(t(z).x),()=>_()(t(z).y)],oe),y(H,$)};M(o,H=>{(q()||[N(),ne()].includes(f()[b][w]))&&H(d)})}y(p,C)}),y(l,s)},te=(l,s)=>{{var g=p=>{var z=F(),b=G(z);he(b,1,()=>t(K),_e,(C,o,d)=>{var H=F(),$=G(H);{var ae=B=>{var D=je(),E=G(D);{var Ke=m=>{var n=Ze();v(n,"r",we),P(n,(k,le)=>O==null?void 0:O(k,le),()=>({disable:f()[d][0][w]!==N()})),se((k,le,We)=>{v(n,"cx",k),v(n,"cy",le),v(n,"fill",We)},[()=>Z()(t(o)[t(o).length-1].x),()=>_()(t(o)[t(o).length-1].y),()=>q()&&X().z?Y()(f()[d][0]):f()[d][0][w]===N()?Q:U],oe),y(m,n)};M(E,m=>{ce()&&m(Ke)})}var S=de(E),Oe=re(S);P(S,(m,n)=>{var k;return(k=Ee)==null?void 0:k(m,n)},()=>({disable:!Le(),width:+xe().left})),P(S,(m,n)=>O==null?void 0:O(m,n),()=>({disable:f()[d][0][w]!==N()})),P(S,(m,n)=>R==null?void 0:R(m,n),()=>({first:d===0})),se((m,n,k)=>{v(S,"transform",`translate(${ce()?7:4},3)`),v(S,"fill",m),v(S,"x",n),v(S,"y",k),ve(Oe,J()?J():f()[d][0][fe])},[()=>q()&&X().z?Y()(f()[d][0]):f()[d][0][w]===N()?Q:U,()=>Z()(t(o)[t(o).length-1].x),()=>j()&&t(o)[t(o).length-1].ly?t(o)[t(o).length-1].ly:_()(t(o)[t(o).length-1].y)],oe),y(B,D)};M($,B=>{(q()||[N(),ne()].includes(f()[d][0][w]))&&B(ae)})}y(C,H)}),y(p,z)};M(l,p=>{var z,b,C;(C=(b=(z=t(K))==null?void 0:z[0])==null?void 0:b[0])!=null&&C.x&&p(g)},s)}};M(ee,l=>{var s,g;(g=(s=t(K))==null?void 0:s[0])!=null&&g.x?l(W):l(te,!1)})}y(r,i)};M(Ae,r=>{t(K)&&r(Ge)})}y(x,ie),Fe(),h()}export{lt as L,Pe as r};
