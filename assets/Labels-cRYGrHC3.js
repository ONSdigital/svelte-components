import{p as Me,T as Oe,a as A,W as L,l as qe,b as Be,c as F,f as G,i as O,g as t,m as ge,e as y,h as Fe,X as Ie,U,k as de,n as re,s as me,d as Je,t as se,o as oe,q as ve}from"./iframe-BLXsI76k.js";import{i as Te}from"./create-runtime-stories-CPJgW_6A.js";import{e as he,i as _e}from"./each-yAAvqgqu.js";import{a as E}from"./actions-8LIRunwB.js";import{s as v}from"./attributes-BkDU35oC.js";import{w as De}from"./DotPlotChart.svelte_svelte_type_style_lang-D8bS1vE2.js";function Ee(x){x.nextSibling&&x.parentNode.appendChild(x)}const Ue=(x,a)=>{let c=x.map((h,e)=>h-e*a*2);return Xe(c).map((h,e)=>h+e*a*2)},Xe=x=>{let a=[];for(let h of x)for(a.push({size:1,mean:h});a.length>1;){let e=a[a.length-2],_=a[a.length-1];if(e.mean<_.mean)break;e.mean=(e.mean*e.size+_.mean*_.size)/(e.size+_.size),e.size=e.size+_.size,a.pop()}let c=[];for(const h of a)for(let e=0;e<h.size;e++)c.push(h.mean);return c};var Ye=U('<text class="chart-label svelte-1yprmt" transform="translate(5,-5)" filter="url(#bgfill)"> </text>'),Ze=U("<circle></circle>"),je=U('<!><text class="chart-label svelte-1yprmt" filter="url(#bgfill)"> </text>',1),Pe=U('<defs><filter x="0" y="0" width="1" height="1" id="bgfill"><feFlood flood-color="rgba(255,255,255,0.8)" result="bg"></feFlood><feMerge><feMergeNode in="bg"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g class="chart-label-group"><!></g>',1);function lt(x,a){Me(a,!1);const[c,h]=Ie(),e=()=>L(ke,"$custom",c),_=()=>L(ye,"$yScale",c),I=()=>L(Ne,"$coords",c),f=()=>L(pe,"$data",c),X=()=>L(Se,"$config",c),Y=()=>L(ue,"$zGet",c),Z=()=>L(be,"$xScale",c),xe=()=>L(ze,"$padding",c),K=ge(),{data:pe,xScale:be,yScale:ye,zGet:ue,padding:ze,config:Se,custom:ke}=Oe("LayerCake");let N=A(a,"hovered",8,null),ne=A(a,"selected",8,null),q=A(a,"labelAll",8,!1),j=A(a,"spreadLabels",8,!1),J=A(a,"content",8,null),ce=A(a,"marker",8,!1),Le=A(a,"textWrap",8,!1),Ne=e().coords,w=e().idKey,fe=e().labelKey,P=e().colorHover?e().colorHover:"orange",Q=e().colorSelect?e().colorSelect:"#206095",V=ge(8),we=4;const Ce=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/,W=(r,i={})=>{i.disable||Ee(r)},R=(r,i={})=>{i.first&&me(V,r.getBBox().height/2)},$e=(r,i)=>{const u=Array.from(r.keys()).sort((l,s)=>r[s][r[s].length-1].y-r[l][r[l].length-1].y),ee=Array.from(u.keys()).map(l=>u.indexOf(l));let H=r.map((l,s)=>r[u[s]]);const te=Ue(H.map(l=>_()(l[l.length-1].y)),i);return H=H.map((l,s)=>{const g=JSON.parse(JSON.stringify(l));return g.forEach(p=>{Ce.test(p.x)&&(p.x=new Date(p.x))}),g[g.length-1].ly=te[s],g}),ee.map(l=>H[l])};qe(()=>(I(),Je(j()),t(V)),()=>{var r,i,u;me(K,(u=(i=(r=I())==null?void 0:r[0])==null?void 0:i[0])!=null&&u.y&&j()?$e(I(),t(V)):I())}),Be(),Te();var ie=F(),Ae=G(ie);{var Ge=r=>{var i=Pe(),u=de(G(i)),ee=re(u);{var H=l=>{var s=F(),g=G(s);he(g,1,()=>t(K),_e,(p,z,b)=>{var C=F(),o=G(C);{var d=M=>{var $=Ye(),ae=re($);se((B,T,D)=>{v($,"fill",B),v($,"x",T),v($,"y",D),ve(ae,J()?J():f()[b][fe])},[()=>q()&&X().z?Y()(f()[b]):f()[b][w]===N()?P:Q,()=>Z()(t(z).x),()=>_()(t(z).y)],oe),y(M,$)};O(o,M=>{(q()||[N(),ne()].includes(f()[b][w]))&&M(d)})}y(p,C)}),y(l,s)},te=(l,s)=>{{var g=p=>{var z=F(),b=G(z);he(b,1,()=>t(K),_e,(C,o,d)=>{var M=F(),$=G(M);{var ae=B=>{var T=je(),D=G(T);{var Ke=m=>{var n=Ze();v(n,"r",we),E(n,(k,le)=>W==null?void 0:W(k,le),()=>({disable:f()[d][0][w]!==N()})),se((k,le,He)=>{v(n,"cx",k),v(n,"cy",le),v(n,"fill",He)},[()=>Z()(t(o)[t(o).length-1].x),()=>_()(t(o)[t(o).length-1].y),()=>q()&&X().z?Y()(f()[d][0]):f()[d][0][w]===N()?P:Q],oe),y(m,n)};O(D,m=>{ce()&&m(Ke)})}var S=de(D),We=re(S);E(S,(m,n)=>{var k;return(k=De)==null?void 0:k(m,n)},()=>({disable:!Le(),width:+xe().left})),E(S,(m,n)=>W==null?void 0:W(m,n),()=>({disable:f()[d][0][w]!==N()})),E(S,(m,n)=>R==null?void 0:R(m,n),()=>({first:d===0})),se((m,n,k)=>{v(S,"transform",`translate(${ce()?7:4},3)`),v(S,"fill",m),v(S,"x",n),v(S,"y",k),ve(We,J()?J():f()[d][0][fe])},[()=>q()&&X().z?Y()(f()[d][0]):f()[d][0][w]===N()?P:Q,()=>Z()(t(o)[t(o).length-1].x),()=>j()&&t(o)[t(o).length-1].ly?t(o)[t(o).length-1].ly:_()(t(o)[t(o).length-1].y)],oe),y(B,T)};O($,B=>{(q()||[N(),ne()].includes(f()[d][0][w]))&&B(ae)})}y(C,M)}),y(p,z)};O(l,p=>{var z,b,C;(C=(b=(z=t(K))==null?void 0:z[0])==null?void 0:b[0])!=null&&C.x&&p(g)},s)}};O(ee,l=>{var s,g;(g=(s=t(K))==null?void 0:s[0])!=null&&g.x?l(H):l(te,!1)})}y(r,i)};O(Ae,r=>{t(K)&&r(Ge)})}y(x,ie),Fe(),h()}export{lt as L,Ee as r};
