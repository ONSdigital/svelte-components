import{p as fe,a as v,$ as Ue,l as de,b as qe,c as Ne,f as Fe,i as ue,e as M,h as _e,X as Qe,O as Je,s as p,m as f,g as t,W as Ke,d as Xe,j as z,n as e,t as K,k as d,o as pe,q as i,R as X}from"./iframe-CwnOGufI.js";import{i as ge,w as ze,c as Ze,d as ea}from"./create-runtime-stories-CLr9y0ZE.js";import{s as D}from"./attributes-Bmkkxx_O.js";import{s as ye}from"./class-Dzh9Da8g.js";import{s as aa}from"./style-CcY6orqc.js";import{p as ve}from"./event-modifiers-CWmzcjye.js";import"./attributes-Co-1QMVx.js";function ta(_){window!=null&&window.dataLayer&&window.dataLayer.push(_)}var sa=z('<form method="GET" id="global-cookie-message" aria-label="cookie banner"><div><div class="ons-grid"><div class="ons-grid__col ons-col-8@m"><h2 class="ons-cookies-banner__title ons-u-mb-xs"> </h2> <div class="ons-cookies-banner__statement"><p> </p> <p> <a> </a> </p></div></div></div> <div class="ons-grid ons-grid--flex ons-u-mt-s"><div class="ons-grid__col"><button type="submit" class="ons-btn ons-btn--small ons-js-accept-cookies ons-cookies-banner__btn" data-button="accept"><span class="ons-btn__inner"><span class="ons-btn__text"> </span></span></button></div> <div class="ons-grid__col"><button type="button" class="ons-btn ons-btn--small ons-js-reject-cookies ons-cookies-banner__btn" data-button="reject"><span class="ons-btn__inner"><span class="ons-btn__text"> </span></span></button></div> <div class="ons-grid__col"><a class="ons-cookies-banner__link"> </a></div></div></div></form>'),na=z('<div><div class="ons-grid ons-grid--flex ons-grid--between ons-grid--gutterless ons-grid--no-wrap@s ons-grid--vertical-center"><div class="ons-grid__col ons-grid__col--flex ons-col-auto ons-u-flex-shrink@s"><p class="ons-cookies-banner__desc ons-u-mb-no@s ons-u-mr-s@s"><span> </span> <span class="ons-cookies-banner__preferences-text"> <a> </a> </span></p></div> <div class="ons-grid__col"><button type="button" class="ons-btn ons-btn--secondary ons-btn--small ons-js-hide-button"><span class="ons-btn__inner"><span class="ons-btn__text"> </span></span></button></div></div></div>'),oa=z('<div class="ons-cookies-banner svelte-pljvs8" role="region" aria-label="Cookies banner"><!></div>');function me(_,u){fe(u,!1);const[ke,we]=Qe(),g=()=>Ke(O(),"$page",ke),n=f();let be=v(u,"analyticsId",8,"GTM-MBCBVQS"),Z=v(u,"analyticsProps",24,()=>({})),O=v(u,"page",24,()=>Je("page")),xe=v(u,"hideBanner",8,!1),W=v(u,"usageCookies",12,!1),ee=v(u,"width",8,"wide"),ae=v(u,"pageViewEnabled",8,!0),te,P=f(!1),se=f(!1),ne=f(""),m=f("en"),h=f("https://www.ons.gov.uk"),k=null;function Ce(){var s;const a=((s=O())==null?void 0:s.url)||document.location;p(m,a.host.startsWith("cy")?"cy":"en"),p(h,t(m)==="cy"?"https://cy.ons.gov.uk":"https://www.ons.gov.uk")}function Ae(){return-1<document.cookie.indexOf("ons_cookie_message_displayed=true")}function je(a,s){const l=new RegExp(`'${a}':(.*?)[,}]`),o=s.match(l);return o?o[1]:null}function Be(){var a=document.cookie.match(new RegExp("(^|;) ?cookies_policy=([^;]*)(;|$)"));if(a){console.debug("legacy cookies_policy found");var s=decodeURIComponent(a[2]),l=JSON.parse(s);return console.debug("usage is",l.usage),l.usage}var o=document.cookie.match("(?:^|; )ons_cookie_policy=({.*?})");if(o){console.debug("ons_cookie_policy found");var y=je("usage",o[1]);return console.debug("usage is",y),y==="true"}return console.debug("no cookie found - opting out"),!1}function oe(a){let s=31536e3,l=window.location.hostname,o=!0,c=a=="all"?"{'essential':true,'settings':true,'usage':true,'campaigns':true}":"{'essential':true,'settings':false,'usage':false,'campaigns':false}",r="/";document.cookie=`ons_cookie_message_displayed=${o};max-age=${s};domain=${l};path=${r};`,document.cookie=`ons_cookie_policy=${c};max-age=${s};domain=${l};path=${r};`,p(ne,`You have ${a=="all"?"accepted":"rejected"} all additional cookies.`),a=="all"&&W(!0),p(se,!0),a=="all"&&ie()}function ie(){console.log("initialising analytics"),window.dataLayer=[{analyticsOptOut:!1,"gtm.whitelist":["google","hjtc","lcl"],"gtm.blacklist":["customScripts","sp","adm","awct","k","d","j"],...Z()}],function(a,s,l,o,y){a[o]=a[o]||[],a[o].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var V=s.head,c=s.createElement(l),r="";c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id="+y+r,V.appendChild(c)}(window,document,"script","dataLayer",be()),g()&&(k=`${g().url.href}`.replace(g().url.hash,""))}function De(a){if(a&&k){const s=`${a.url.href}`.replace(a.url.hash,"");s!==k&&(k=s,ta({event:"pageView",pageURL:k,...Z()}))}}Ue(()=>{Ce(),te=!0,O()||p(m,document.location.host.startsWith("cy")?"cy":"en"),p(P,!Ae()),W(Be()),W()&&te&&ie()});const le={"Cookies on ons.gov.uk":"Cwcis ar ons.gov.uk","Cookies are small files stored on your device when you visit a website. We use some essential cookies to make this website work.":"Ffeiliau bach a gaiff eu storio ar eich dyfais pan fyddwch yn mynd ar wefan yw cwcis. Rydym ni’n defnyddio rhai cwcis hanfodol i wneud i’r wefan hon weithio.","We would like to set":"Hoffem osod","additional cookies":"cwcis ychwanegol","to remember your settings and understand how you use the site. This helps us to improve our services.":"er mwyn cofio eich gosodiadau a deall sut rydych chi’n defnyddio’r wefan. Mae hyn yn ein helpu ni i wella ein gwasanaethau.","Accept additional cookies":"Derbyn cwcis ychwanegol","Reject additional cookies":"Gwrthod cwcis ychwanegol","View cookies":"Gweld cwcis","You have accepted all additional cookies.":"Rydych chi wedi derbyn yr holl gwcis ychwanegol.","You have rejected all additional cookies.":"Rydych chi wedi gwrthod yr holl gwcis ychwanegol.","You can":"Gallwch chi","change your cookie preferences":"newid eich dewisiadau o ran cwcis","at any time.":"ar unrhyw adeg.",Hide:"Cuddio","Hide this message":"Cuddiwch y neges yma"};de(()=>(Xe(ae()),g()),()=>{ae()&&De(g())}),de(()=>t(m),()=>{p(n,a=>t(m)==="cy"&&le[a]?le[a]:a)}),qe(),ge();var ce=Ne(),Pe=Fe(ce);{var Ve=a=>{var s=oa();let l;var o=e(s);{var y=c=>{var r=sa(),w=e(r);let E;var b=e(w),I=e(b),x=e(I),L=e(x),Y=d(x,2),C=e(Y),A=e(C),H=d(C,2),R=e(H),j=d(R),B=e(j),U=d(j),q=d(b,2),T=e(q),S=e(T),N=e(S),F=e(N),Q=e(F),$=d(T,2),G=e($),J=e(G),Ee=e(J),Re=e(Ee),Te=d($,2),re=e(Te),Se=e(re);K(($e,Ge,Me,Oe,We,Ie,Le,Ye,He)=>{D(r,"action",t(h)+"/cookies/accept-all"),E=ye(w,1,"ons-container ons-cookies-banner__primary svelte-pljvs8",null,E,$e),i(L,Ge),i(A,Me),i(R,`${Oe??""} `),D(j,"href",t(h)+"/cookies"),i(B,We),i(U,` ${Ie??""}`),i(Q,Le),i(Re,Ye),D(re,"href",t(h)+"/cookies"),i(Se,He)},[()=>({"ons-page__container--wider":ee()==="wider"}),()=>t(n)("Cookies on ons.gov.uk"),()=>t(n)("Cookies are small files stored on your device when you visit a website. We use some essential cookies to make this website work."),()=>t(n)("We would like to set"),()=>t(n)("additional cookies"),()=>t(n)("to remember your settings and understand how you use the site. This helps us to improve our services."),()=>t(n)("Accept additional cookies"),()=>t(n)("Reject additional cookies"),()=>t(n)("View cookies")],pe),X("click",S,ve(()=>oe("all"))),X("click",G,ve(()=>oe("reject"))),M(c,r)},V=c=>{var r=na();let w;var E=e(r),b=e(E),I=e(b),x=e(I),L=e(x),Y=d(x,2),C=e(Y),A=d(C),H=e(A),R=d(A),j=d(b,2),B=e(j),U=e(B),q=e(U),T=e(q);K((S,N,F,Q,$,G,J)=>{w=ye(r,1,"ons-container ons-cookies-banner__confirmation svelte-pljvs8",null,w,S),i(L,N),i(C,`${F??""} `),D(A,"href",t(h)+"/cookies"),i(H,Q),i(R,` ${$??""}.`),D(B,"aria-label",G),i(T,J)},[()=>({"ons-page__container--wider":ee()==="wider"}),()=>t(n)(t(ne)),()=>t(n)("You can"),()=>t(n)("change your cookie preferences"),()=>t(n)("at any time"),()=>t(n)("Hide this message"),()=>t(n)("Hide")],pe),X("click",B,()=>p(P,!1)),M(c,r)};ue(o,c=>{t(se)?c(V,!1):c(y)})}K(()=>l=aa(s,"",l,{display:t(P)?"block":null})),M(a,s)};ue(Pe,a=>{t(P)&&!xe()&&a(Ve)})}M(_,ce),_e(),we()}me.__docgen={data:[{name:"analyticsId",visibility:"public",description:"Google analytics/tags manager ID",keywords:[],kind:"let",type:{kind:"type",type:"string",text:"string"},static:!1,readonly:!1,defaultValue:'"GTM-MBCBVQS"'},{name:"analyticsProps",visibility:"public",description:"Optional props to describe the content",keywords:[],kind:"let",static:!1,readonly:!1,defaultValue:"{}"},{name:"page",visibility:"public",description:'Optional: Pass the "page" store from "$app/state" in SvelteKit (gets read from context by default if it exists)',keywords:[],kind:"let",type:{kind:"type",type:"any",text:"any"},static:!1,readonly:!1,defaultValue:"..."},{name:"hideBanner",visibility:"public",description:"Use this to hide the banner (only initialises analytics if cookies already accepted)",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"usageCookies",visibility:"public",description:"Bind to this value if you need to know if cookies have been accepted",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"false"},{name:"width",visibility:"public",description:"Set the width of the banner",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"string",value:"wide",text:'"wide"'},{kind:"const",type:"string",value:"wider",text:'"wider"'}],text:'"wide" | "wider"'},static:!1,readonly:!1,defaultValue:'"wide"'},{name:"pageViewEnabled",visibility:"public",description:"Enable automatic pageView event on route changes",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1,defaultValue:"true"}],name:"AnalyticsBanner.svelte"};const ia=`This component will display a cookie banner and export a function that allows you to push events to the Google Analytics dataLayer array.

<!-- prettier-ignore -->
\`\`\`html
<script>
  import { AnalyticsBanner, AnalyticsEvent } from "@onsvisual/svelte-components";

  // Example of an analytics event triggered by another event "e"
  function doAnalyticsEvent(e) {
    // Assumes that e.detail is in the form {key1: "value1", key2: "value2", etc}
    AnalyticsEvent({event: "eventName", ...e.detail});
  }
<\/script>

<AnalyticsBanner analyticsId="{id_string}" />
<!-- Rest of page content -->
\`\`\`

\`AnalyticsBanner\` can also take props.

\`\`\`
const analyticsProps = {
    contentTitle: "Weekly deaths dashboard",
    releaseDate: data.dates.current.replaceAll("-", ""),
    nextReleaseDate: data.dates.next.replaceAll("-", ""),
    outputSeries: "weeklyprovisionalfiguresondeathsregisteredinenglandandwales",
    contentType: "dashboard",
  };

<AnalyticsBanner {analyticsProps}/>
\`\`\`

An example analytics events. See this [doc](https://officenationalstatistics.sharepoint.com/:w:/r/sites/digpub/_layouts/15/Doc.aspx?sourcedoc=%7BBA405554-4040-4B61-9559-851F5C55DA39%7D&file=Google%20Analytics%20-%20GTM%20requirements.docx&action=default&mobileredirect=true) for more details (need to be on network).

\`\`\`javascript
analyticsEvent({
	event: "interaction",
	interactionType: "accordion",
	interactionValue: e?.detail?.open ? "open" : "close",
	label,
	sectionTitle,
	sectionNumber
});
\`\`\`
`,la={title:"Layout/AnalyticsBanner",component:me,tags:["autodocs"],argTypes:{},parameters:{...ze(ia),layout:"fullscreen"}},{Story:ca}=ea();function he(_,u){fe(u,!1),ge(),ca(_,{name:"Default",args:{},parameters:{__svelteCsf:{rawCode:"<AnalyticsBanner {...args} />"}}}),_e()}he.__docgen={data:[],name:"AnalyticsBanner.stories.svelte"};const ra=Ze(he,la),ga=["Default"],ma={...ra.Default,tags:["svelte-csf-v5"]};export{ma as Default,ga as __namedExportsOrder,la as default};
