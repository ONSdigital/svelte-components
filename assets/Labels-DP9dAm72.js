import{p as He,P as Me,a as q,W as w,l as Oe,b as Be,c as F,f as A,i as M,g as t,m as de,e as y,h as Fe,X as Ie,U as T,k as ge,n as re,s as me,d as Je,t as se,o as oe,q as ve}from"./iframe-CbtXQGpi.js";import{i as De}from"./create-runtime-stories-C0J-SdQq.js";import{e as he,i as _e}from"./each-DwLTWgD7.js";import{a as P}from"./actions-Bt_Gtp1j.js";import{s as v}from"./attributes-DtFI45NK.js";import{w as Ee}from"./DotPlotChart.svelte_svelte_type_style_lang-DOyg-fMj.js";function Pe(x){x.nextSibling&&x.parentNode.appendChild(x)}const Te=(x,a)=>{let c=x.map((h,e)=>h-e*a*2);return Ue(c).map((h,e)=>h+e*a*2)},Ue=x=>{let a=[];for(let h of x)for(a.push({size:1,mean:h});a.length>1;){let e=a[a.length-2],_=a[a.length-1];if(e.mean<_.mean)break;e.mean=(e.mean*e.size+_.mean*_.size)/(e.size+_.size),e.size=e.size+_.size,a.pop()}let c=[];for(const h of a)for(let e=0;e<h.size;e++)c.push(h.mean);return c};var Xe=T('<text class="chart-label svelte-dqkttw" transform="translate(5,-5)" filter="url(#bgfill)"> </text>'),Ye=T("<circle></circle>"),Ze=T('<!><text class="chart-label svelte-dqkttw" filter="url(#bgfill)"> </text>',1),je=T('<defs><filter x="0" y="0" width="1" height="1" id="bgfill"><feFlood flood-color="rgba(255,255,255,0.8)" result="bg"></feFlood><feMerge><feMergeNode in="bg"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g class="chart-label-group"><!></g>',1);function lt(x,a){He(a,!1);const[c,h]=Ie(),e=()=>w(ke,"$custom",c),_=()=>w(ye,"$yScale",c),I=()=>w(Le,"$coords",c),f=()=>w(pe,"$data",c),U=()=>w(Se,"$config",c),X=()=>w(ue,"$zGet",c),Y=()=>w(be,"$xScale",c),xe=()=>w(ze,"$padding",c),G=de(),{data:pe,xScale:be,yScale:ye,zGet:ue,padding:ze,config:Se,custom:ke}=Me("LayerCake");let L=q(a,"hovered",8,null),ne=q(a,"selected",8,null),O=q(a,"labelAll",8,!1),Z=q(a,"spreadLabels",8,!1),J=q(a,"content",8,null),ce=q(a,"marker",8,!1),we=q(a,"textWrap",8,!1),Le=e().coords,N=e().idKey,fe=e().labelKey,j=e().colorHover?e().colorHover:"orange",Q=e().colorSelect?e().colorSelect:"#206095",V=de(8),Ne=4;const Ce=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/,K=(r,i={})=>{i.disable||Pe(r)},R=(r,i={})=>{i.first&&me(V,r.getBBox().height/2)},$e=(r,i)=>{const u=Array.from(r.keys()).sort((l,s)=>r[s][r[s].length-1].y-r[l][r[l].length-1].y),ee=Array.from(u.keys()).map(l=>u.indexOf(l));let W=r.map((l,s)=>r[u[s]]);const te=Te(W.map(l=>_()(l[l.length-1].y)),i);return W=W.map((l,s)=>{const d=JSON.parse(JSON.stringify(l));return d.forEach(p=>{Ce.test(p.x)&&(p.x=new Date(p.x))}),d[d.length-1].ly=te[s],d}),ee.map(l=>W[l])};Oe(()=>(I(),Je(Z()),t(V)),()=>{var r,i,u;me(G,(u=(i=(r=I())==null?void 0:r[0])==null?void 0:i[0])!=null&&u.y&&Z()?$e(I(),t(V)):I())}),Be(),De();var ie=F(),qe=A(ie);{var Ae=r=>{var i=je(),u=ge(A(i)),ee=re(u);{var W=l=>{var s=F(),d=A(s);he(d,1,()=>t(G),_e,(p,z,b)=>{var C=F(),o=A(C);{var g=H=>{var $=Xe(),ae=re($);se((B,D,E)=>{v($,"fill",B),v($,"x",D),v($,"y",E),ve(ae,J()?J():f()[b][fe])},[()=>O()&&U().z?X()(f()[b]):f()[b][N]===L()?j:Q,()=>Y()(t(z).x),()=>_()(t(z).y)],oe),y(H,$)};M(o,H=>{(O()||[L(),ne()].includes(f()[b][N]))&&H(g)})}y(p,C)}),y(l,s)},te=(l,s)=>{{var d=p=>{var z=F(),b=A(z);he(b,1,()=>t(G),_e,(C,o,g)=>{var H=F(),$=A(H);{var ae=B=>{var D=Ze(),E=A(D);{var Ge=m=>{var n=Ye();v(n,"r",Ne),P(n,(k,le)=>K==null?void 0:K(k,le),()=>({disable:f()[g][0][N]!==L()})),se((k,le,We)=>{v(n,"cx",k),v(n,"cy",le),v(n,"fill",We)},[()=>Y()(t(o)[t(o).length-1].x),()=>_()(t(o)[t(o).length-1].y),()=>O()&&U().z?X()(f()[g][0]):f()[g][0][N]===L()?j:Q],oe),y(m,n)};M(E,m=>{ce()&&m(Ge)})}var S=ge(E),Ke=re(S);P(S,(m,n)=>{var k;return(k=Ee)==null?void 0:k(m,n)},()=>({disable:!we(),width:+xe().left})),P(S,(m,n)=>K==null?void 0:K(m,n),()=>({disable:f()[g][0][N]!==L()})),P(S,(m,n)=>R==null?void 0:R(m,n),()=>({first:g===0})),se((m,n,k)=>{v(S,"transform",`translate(${ce()?7:4},3)`),v(S,"fill",m),v(S,"x",n),v(S,"y",k),ve(Ke,J()?J():f()[g][0][fe])},[()=>O()&&U().z?X()(f()[g][0]):f()[g][0][N]===L()?j:Q,()=>Y()(t(o)[t(o).length-1].x),()=>Z()&&t(o)[t(o).length-1].ly?t(o)[t(o).length-1].ly:_()(t(o)[t(o).length-1].y)],oe),y(B,D)};M($,B=>{(O()||[L(),ne()].includes(f()[g][0][N]))&&B(ae)})}y(C,H)}),y(p,z)};M(l,p=>{var z,b,C;(C=(b=(z=t(G))==null?void 0:z[0])==null?void 0:b[0])!=null&&C.x&&p(d)},s)}};M(ee,l=>{var s,d;(d=(s=t(G))==null?void 0:s[0])!=null&&d.x?l(W):l(te,!1)})}y(r,i)};M(qe,r=>{t(G)&&r(Ae)})}y(x,ie),Fe(),h()}export{lt as L,Pe as r};
